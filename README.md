# Sequential-Search-Model-R-Conversion
A conversion of the MATLAB code for the GHK estimation of the homogenous Weitzmann Sequential Search Model from Ursu, Seiler, Honka (2024). The resulting code is in R, following an analogous structure and function, so the overall project architecture (and variable naming) was not of my design.

While the MATLAB code replicates the estimation script for all 50 Monte Carlo seeds, R lacks a filename self-reference feature like mfilename, and so the code has been re-engineered such that the _same_ estimation script is ran 50 times, but with the seed passed as an argument. This achieves an identical result.

Note that exact replication of the MATLAB results is hindered by different RNG implementations between languages - both use a Mersenne-Twister algorithm but with different transformations and lower-level C implementations, so results will not be exactly the same. That said, the validity of the likelihood implementation has been verified using identical data and RNG inputs for various consumer examples.

Please note: much code is written by hand, other parts are LLM-assisted (especially the implementation of the third-party optimiser and the base likelihood function) but checked and edited for accuracy. For more precise knowledge of the authorship of each part of the code feel free to contact me on hayden.dyke23@imperial.ac.uk. If in doubt assume code is not mine.

---

## Structure Tree

```
Sequential-Search-Model-R-Conversion
├── README.md # description of project
└── main # main container folder of R code
    ├── main.R # command script (runs estimation and averaging scripts over 50 seeds)
    ├── average.R # script to average results of estimation for each seed
    ├── cal_se_num_hessian.R # script to calculate standard errors of estimates
    ├── estWeitz_ghk_D100.R # main estimation script (D100 represents 100 error draws)
    ├── fminsearchcon.R # optimiser script (LLM copy of third-party MATLAB)
    ├── liklWeitz_ghk_1 # first part of likelihood function (prepares data and handles output)
    ├── liklWeitz_ghk_2 # second part of likelihood function (calculates likelihood values based on GHK specification)
    ├── tableZ.csv # lookup table of m vs search cost c
    └── simWeitz.R # generates simulation data for 50 seeds
└── consumer_data # contains data generated by MATLAB for comparison when running
    └── genWeitzDataS%d.csv # data for each seed, as generated by MATLAB in Ursu, Seiler, Honka 2024
```
---
## How to Run

1) Clone the Repository:
```
git clone https://github.com/SupremeLeader04/Sequential-Search-Model-R-Conversion.git
cd Sequential-Search-Model-R-Conversion
```

2) Data Considerations:
If you want to use the data generated by the MATLAB in Ursu, Seiler, Honka 2024, then copy all 50 csv files directly into the main folder. Else, edit the estimation script to uncomment the simulation data generation part (so the R code generates its own data to use instead).

3) Running:
From here, simply run the main.rmd code, and check the overall_results.csv file for results.
---
